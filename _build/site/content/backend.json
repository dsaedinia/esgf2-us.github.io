{"version":2,"kind":"Article","sha256":"129eee5ce1f8106edc56eea61b04901386fdcf68ebee8121dcad764a46ec920c","slug":"backend","location":"/backend.md","dependencies":[],"frontmatter":{"title":"MetaGrid API Back-end","github":"https://github.com/esgf2-us/esgf2-us.github.io","keywords":[],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/esgf2-us/esgf2-us.github.io/blob/new-Architecture/backend.md","exports":[{"format":"md","filename":"backend.md","url":"/backend-f9b9b169b93e06fd8973d96a0f01eda2.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"STEPS TO UPDATE PROJECTS, FACETS OR CATEGORIES","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"f6UUPdhSw7"}],"identifier":"steps-to-update-projects-facets-or-categories","label":"STEPS TO UPDATE PROJECTS, FACETS OR CATEGORIES","html_id":"steps-to-update-projects-facets-or-categories","implicit":true,"key":"amhNLKKKO0"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Edit the initial data file with the desired changes: metagrid/backend/metagrid/initial_projects_data.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mOhP9akoLG"}],"key":"vhoNupH5B2"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Start the manage_metagrid.sh script in the root directory (use sudo if needed): ./manage_metagrid.sh","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"E5CJTzFPJ8"}],"key":"wv1YzoTc7i"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Select ‘Developer Actions’, then choose “Update Project Table” option. The commands to update should run.\nDONE!","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VxwdvOuYGQ"}],"key":"eT00I4KghD"}],"key":"klXXKMUmtM"},{"type":"heading","depth":2,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Create a new python virtual environment for testing","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"zdFPLpnugt"}],"identifier":"create-a-new-python-virtual-environment-for-testing","label":"Create a new python virtual environment for testing","html_id":"create-a-new-python-virtual-environment-for-testing","implicit":true,"key":"K3nYcf6GaF"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"python3 -m venv backend/venv","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ahXKHioY53"}],"key":"KVOUnR8L7W"},{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Activate virtual env","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"iBxfejif2n"}],"identifier":"activate-virtual-env","label":"Activate virtual env","html_id":"activate-virtual-env","implicit":true,"key":"kFoq8Hyafo"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"source backend/venv/bin/activate","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"TzdZziYwZZ"}],"key":"CYIBkBHmCf"},{"type":"heading","depth":2,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Deactivate virtual env","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"e9G24j8tGq"}],"identifier":"deactivate-virtual-env","label":"Deactivate virtual env","html_id":"deactivate-virtual-env","implicit":true,"key":"kuqV4inPCR"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"deactivate","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"CtEUR72Nca"}],"key":"BzhWAQUDGw"},{"type":"heading","depth":2,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Run pre-commit process on all files (will run flake8, black etc.)","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Ic6tFqvlcf"}],"identifier":"run-pre-commit-process-on-all-files-will-run-flake8-black-etc","label":"Run pre-commit process on all files (will run flake8, black etc.)","html_id":"run-pre-commit-process-on-all-files-will-run-flake8-black-etc","implicit":true,"key":"T1yKoFg8Jq"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"pre-commit run --all-files","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"N9VjgjQNl9"}],"key":"CQBzOhfWrW"},{"type":"heading","depth":2,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Use Black formatting, cd to backend","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"hLzPZi2WNW"}],"identifier":"use-black-formatting-cd-to-backend","label":"Use Black formatting, cd to backend","html_id":"use-black-formatting-cd-to-backend","implicit":true,"key":"p8A0VtfIl6"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"black .","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"huR3U3uMJb"}],"key":"tpggJThbag"},{"type":"heading","depth":2,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Run Flake8 to linter in backend, cd to backend","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"gJi7zX9kdx"}],"identifier":"run-flake8-to-linter-in-backend-cd-to-backend","label":"Run Flake8 to linter in backend, cd to backend","html_id":"run-flake8-to-linter-in-backend-cd-to-backend","implicit":true,"key":"t2fqNy7AgA"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"flake8 .","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"kOytW1UQln"}],"key":"M1LXzMY8uc"},{"type":"heading","depth":2,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Update virtual environment with current requirements (after activating it)","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"SVzO6JKIe4"}],"identifier":"update-virtual-environment-with-current-requirements-after-activating-it","label":"Update virtual environment with current requirements (after activating it)","html_id":"update-virtual-environment-with-current-requirements-after-activating-it","implicit":true,"key":"RkrSXiKdQH"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"pip install -r requirements/local.txt","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"UDB705XQFz"}],"key":"he7rZUB98Z"},{"type":"heading","depth":2,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Rebuild container for testing backend","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"VdMr7UyJvr"}],"identifier":"rebuild-container-for-testing-backend","label":"Rebuild container for testing backend","html_id":"rebuild-container-for-testing-backend","implicit":true,"key":"Fh1RjxcrhT"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm build --no-cache","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"uFhlLr0Rk6"}],"key":"rXG3SZGHEU"},{"type":"heading","depth":2,"position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Run pyTest (May need to rebuild container before tests)","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"VgTwYFs41v"}],"identifier":"run-pytest-may-need-to-rebuild-container-before-tests","label":"Run pyTest (May need to rebuild container before tests)","html_id":"run-pytest-may-need-to-rebuild-container-before-tests","implicit":true,"key":"mODsnFI6PD"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm django pytest","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"V9qz1hwIhn"}],"key":"Jnx8M5yFja"},{"type":"heading","depth":2,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Run pyTest for a specific test (example)","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"LwP7jVjdDk"}],"identifier":"run-pytest-for-a-specific-test-example","label":"Run pyTest for a specific test (example)","html_id":"run-pytest-for-a-specific-test-example","implicit":true,"key":"qFss50QpSE"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm django pytest metagrid/api_proxy/tests/test_views.py::TestProxyViewSet::test_do_globus_auth","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"hkk1Tls1Uu"}],"key":"LS7uMdOjWZ"},{"type":"heading","depth":2,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Run manage.py function","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"mIEbiKMh8W"}],"identifier":"run-manage-py-function","label":"Run manage.py function","html_id":"run-manage-py-function","implicit":true,"key":"HWpFHDQiXo"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm django python manage.py","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"zKZERUXMdU"}],"key":"jRiSWnw5kE"},{"type":"heading","depth":2,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Run migrations","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"dJ2XGTtaZC"}],"identifier":"run-migrations","label":"Run migrations","html_id":"run-migrations","implicit":true,"key":"QgQyXb09nI"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm django python manage.py migrate","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"vSPE59O6RQ"}],"key":"caSnmjZhAP"},{"type":"heading","depth":3,"position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Helpful Links:","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"YQcQXjL2CN"}],"identifier":"helpful-links","label":"Helpful Links:","html_id":"helpful-links","implicit":true,"key":"W5HG8uAU36"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":62,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"inlineCode","value":"Back-end Docs","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"aE2Ce6RHvq"},{"type":"text","value":": ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"cpKcURwi2a"},{"type":"link","url":"https://metagrid.readthedocs.io/en/latest/contributors/backend_development/","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Back-end Development","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"dhekjGrKxm"}],"urlSource":"https://metagrid.readthedocs.io/en/latest/contributors/backend_development/","key":"CFnQrrnq6T"}],"key":"gnNrlgfcoW"},{"type":"listItem","spread":true,"position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"inlineCode","value":"Back-end Development Github","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"y68vfSQWdO"},{"type":"text","value":": ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"E16ko7b7jA"},{"type":"link","url":"https://github.com/esgf2-us/metagrid/tree/master/backend","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"Github Back-end","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"U9T6g1XMse"}],"urlSource":"https://github.com/esgf2-us/metagrid/tree/master/backend","error":true,"key":"tEpODZwAD1"}],"key":"chLm4aLS5X"}],"key":"LzCUaN5Klw"}],"key":"RCYwgdSUYj"}],"key":"ZrPoQPYSgN"},"references":{"cite":{"order":[],"data":{}}}}