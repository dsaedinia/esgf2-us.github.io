{"version":2,"kind":"Article","sha256":"129eee5ce1f8106edc56eea61b04901386fdcf68ebee8121dcad764a46ec920c","slug":"backend","location":"/backend.md","dependencies":[],"frontmatter":{"title":"MetaGrid API Back-end","github":"https://github.com/esgf2-us/esgf2-us.github.io","keywords":[],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/esgf2-us/esgf2-us.github.io/blob/new-Architecture/backend.md","exports":[{"format":"md","filename":"backend.md","url":"/backend-f9b9b169b93e06fd8973d96a0f01eda2.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"STEPS TO UPDATE PROJECTS, FACETS OR CATEGORIES","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"onvojJX2K3"}],"identifier":"steps-to-update-projects-facets-or-categories","label":"STEPS TO UPDATE PROJECTS, FACETS OR CATEGORIES","html_id":"steps-to-update-projects-facets-or-categories","implicit":true,"key":"ggfUhOrbxt"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Edit the initial data file with the desired changes: metagrid/backend/metagrid/initial_projects_data.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pQ7WDEbiI7"}],"key":"itvyJXu9lT"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Start the manage_metagrid.sh script in the root directory (use sudo if needed): ./manage_metagrid.sh","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Qxp3M6LGRC"}],"key":"ZxLLLs893X"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Select ‘Developer Actions’, then choose “Update Project Table” option. The commands to update should run.\nDONE!","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DeTJYwDNpy"}],"key":"Ts5fxPv3RU"}],"key":"ZT9bePnD1x"},{"type":"heading","depth":2,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Create a new python virtual environment for testing","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"pCf7AbGijC"}],"identifier":"create-a-new-python-virtual-environment-for-testing","label":"Create a new python virtual environment for testing","html_id":"create-a-new-python-virtual-environment-for-testing","implicit":true,"key":"Xv1Uv8rP4F"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"python3 -m venv backend/venv","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"j8kWizdtzF"}],"key":"WtwuZZGBD6"},{"type":"heading","depth":2,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Activate virtual env","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"kba9gUL9Gt"}],"identifier":"activate-virtual-env","label":"Activate virtual env","html_id":"activate-virtual-env","implicit":true,"key":"jUKFNcrcoj"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"source backend/venv/bin/activate","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"cEk0jZa2In"}],"key":"PsMLe7YcRH"},{"type":"heading","depth":2,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Deactivate virtual env","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"eOdHk2BQZD"}],"identifier":"deactivate-virtual-env","label":"Deactivate virtual env","html_id":"deactivate-virtual-env","implicit":true,"key":"shwBEgglGh"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"deactivate","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"JgtgIRNf4s"}],"key":"cHuaRlujSo"},{"type":"heading","depth":2,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Run pre-commit process on all files (will run flake8, black etc.)","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"nh4XX2xtEL"}],"identifier":"run-pre-commit-process-on-all-files-will-run-flake8-black-etc","label":"Run pre-commit process on all files (will run flake8, black etc.)","html_id":"run-pre-commit-process-on-all-files-will-run-flake8-black-etc","implicit":true,"key":"fWK8hAl33y"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"pre-commit run --all-files","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"bwhHut47xU"}],"key":"u7fvXXWFq1"},{"type":"heading","depth":2,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Use Black formatting, cd to backend","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"dTi2l9QxCF"}],"identifier":"use-black-formatting-cd-to-backend","label":"Use Black formatting, cd to backend","html_id":"use-black-formatting-cd-to-backend","implicit":true,"key":"NG6Qjbhbr6"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"black .","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"G0Ws4O2Zwh"}],"key":"YfLJKhA2YX"},{"type":"heading","depth":2,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Run Flake8 to linter in backend, cd to backend","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"qMSm4B8BpT"}],"identifier":"run-flake8-to-linter-in-backend-cd-to-backend","label":"Run Flake8 to linter in backend, cd to backend","html_id":"run-flake8-to-linter-in-backend-cd-to-backend","implicit":true,"key":"HXB2gqHQRR"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"flake8 .","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"kox1LfFK4c"}],"key":"nyhZ8iEzbg"},{"type":"heading","depth":2,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Update virtual environment with current requirements (after activating it)","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"kKzshnbrTK"}],"identifier":"update-virtual-environment-with-current-requirements-after-activating-it","label":"Update virtual environment with current requirements (after activating it)","html_id":"update-virtual-environment-with-current-requirements-after-activating-it","implicit":true,"key":"CsSCrS56Cq"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"pip install -r requirements/local.txt","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"FLoArlUpJX"}],"key":"uMxg6kKkdl"},{"type":"heading","depth":2,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Rebuild container for testing backend","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"s4JIzxgaNy"}],"identifier":"rebuild-container-for-testing-backend","label":"Rebuild container for testing backend","html_id":"rebuild-container-for-testing-backend","implicit":true,"key":"qaTnisMkAf"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm build --no-cache","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"imQfVwjbkQ"}],"key":"FvGvHuVOAc"},{"type":"heading","depth":2,"position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Run pyTest (May need to rebuild container before tests)","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"gjyQifHTcJ"}],"identifier":"run-pytest-may-need-to-rebuild-container-before-tests","label":"Run pyTest (May need to rebuild container before tests)","html_id":"run-pytest-may-need-to-rebuild-container-before-tests","implicit":true,"key":"U7LUpx3hDi"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm django pytest","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"qNMCVvBUnQ"}],"key":"tjmNYOCC0M"},{"type":"heading","depth":2,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Run pyTest for a specific test (example)","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"TUZqhNO4nb"}],"identifier":"run-pytest-for-a-specific-test-example","label":"Run pyTest for a specific test (example)","html_id":"run-pytest-for-a-specific-test-example","implicit":true,"key":"A8Ldj4lpNv"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm django pytest metagrid/api_proxy/tests/test_views.py::TestProxyViewSet::test_do_globus_auth","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"e98HHd4UXH"}],"key":"tHO2rv0s40"},{"type":"heading","depth":2,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Run manage.py function","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"rRV697JLmB"}],"identifier":"run-manage-py-function","label":"Run manage.py function","html_id":"run-manage-py-function","implicit":true,"key":"PhOL9wKM1a"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm django python manage.py","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"Zffjzq3qUh"}],"key":"wgyBoYQL14"},{"type":"heading","depth":2,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Run migrations","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"F8MQu2uXPJ"}],"identifier":"run-migrations","label":"Run migrations","html_id":"run-migrations","implicit":true,"key":"xXddspEmLs"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"docker compose -f docker-compose.yml -f docker-compose.local-overlay.yml run --rm django python manage.py migrate","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"EBKe29FTB2"}],"key":"lyNVBSyGLi"},{"type":"heading","depth":3,"position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"Helpful Links:","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"AbQ1loZTBQ"}],"identifier":"helpful-links","label":"Helpful Links:","html_id":"helpful-links","implicit":true,"key":"psU5hZygbh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":62,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"inlineCode","value":"Back-end Docs","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"fJEvuWiu2j"},{"type":"text","value":": ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"ZagmLfSjOi"},{"type":"link","url":"https://metagrid.readthedocs.io/en/latest/contributors/backend_development/","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Back-end Development","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"xtBA85GSyX"}],"urlSource":"https://metagrid.readthedocs.io/en/latest/contributors/backend_development/","key":"x1MNoeG1yf"}],"key":"x0l9Ymrftt"},{"type":"listItem","spread":true,"position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"inlineCode","value":"Back-end Development Github","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"ZnoEL2qYVB"},{"type":"text","value":": ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"b7Yas9W5Au"},{"type":"link","url":"https://github.com/esgf2-us/metagrid/tree/master/backend","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"Github Back-end","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"EoxRlhswge"}],"urlSource":"https://github.com/esgf2-us/metagrid/tree/master/backend","error":true,"key":"SfWIYBT8a5"}],"key":"MlfosSRZux"}],"key":"tqV4As2HVV"}],"key":"xTqOUrwCH9"}],"key":"WlfWemIHsx"},"references":{"cite":{"order":[],"data":{}}}}